<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="true">
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>我的博客</title>
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/pace-theme-flash.css">
    <link rel="stylesheet" href="../css/d-audio.css">
    <link rel="stylesheet" href="../css/article-detail.css">
    <link rel="stylesheet" href="../css/code.css">
    <link rel="stylesheet" href="../css/github-markdown.css">
    <link rel="stylesheet" href="../css/vditor.css">
    <link rel="shortcut icon" href="">
    <link rel="stylesheet" href="../css/like.css">
    <link rel="stylesheet" href="../css/save.css">
    <style>
        .lazy-image {
            background: url('../img/loading.gif') no-repeat center;
            background-size: 26% 35%;
            height: 100%;
            width: 100%;
        }

        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 10px;
        }

        @media (max-width: 767px) {
            .markdown-body {
                padding: 15px;
            }

            .markdown-body h1 {
                font-size: 1.35em;
            }

        }

        .codehilite {
            border-radius: 10px;
        }

        .article-content img {
            max-width: 100%;
        }

        #outerdiv {
            width: 100%;
            height: 100%;
            position: fixed;
            top: 0;
            left: 0;
            background: rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 200;
        }
    </style>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>

<body>
<!--PC导航栏-->
<nav class="nav-bar-holder">
    <div class="nav-bar" id="nav-bar">
        <div class="logo-box">
            <a href="index.html" class="blog-title ta-c"><img style="vertical-align: top;" alt="logo"
                                                              src="辉夜.jpg" /></a>
        </div>
        <div class="nb-a-holder" id="home"><a class="nb-a ta-c" href="index.html">首页</a></div>
        <div class="nb-a-holder"><a class="nb-a ta-c" href="category.html">分类</a></div>
        <div class="nb-a-holder"><a class="nb-a ta-c" href="tag.html">标签墙</a></div>
        <div class="nb-a-holder"><a class="nb-a ta-c" href="archive.html">归档</a></div>
        <div class="nb-a-holder"><a class="nb-a ta-c" href="link.html">友情链接</a></div>
        <!--搜索框-->
        <div id="search-nb">
                <span class="search-s fl">
                    <label for="search-input"></label><input class="fl" type="text" id="search-input"
                                                             placeholder="请输入关键字">
                    <a class="search-icon fl" onclick="search_by_key()" href="javascript:void(0);"></a>
                </span>
        </div>
        <div class="nb-a-holder-last">
            <div class="nb-a-holder-small">
                <a class="a-login" href="login.html"id="mylogin">登录</a>
            </div>
            <div class="nb-a-holder-small">
                <a class="a-login" href="register.html"id="myreg">注册</a>
            </div>
        </div>
    </div>
</nav>
<!--mobile导航栏-->
<nav class="mobile-nav">
    <div class="logo-box">
        <a href="index.html" class="blog-title ta-c">
            <img style="vertical-align: top;" alt="logo" src="辉夜.jpg" /></a>
    </div>
    <a id="mobile_cate" style="background-image: url('../img/cate.svg')" href="javascript:void(0);"></a>
</nav>
<ul id="nav-m-list">
    <li id="cancel-li"><a class="fr" id="cancel" href="javascript:void(0);"></a></li>
    <li id="m-img-li">
        <img id="m-img" alt="苍茫误此生" src="辉夜.jpg">
    </li>
    <li>
            <span class="search-s fl">
                <label for="search-input-m"></label><input class="fl" type="text" id="search-input-m" placeholder="关键词">
                <a class="search-icon fl" onclick="m_search()" href="javascript:void(0);"></a>
            </span>
    </li>
    <li><a class="w-h-100 fl" href="index.html">首页</a></li>
    <li><a class="w-h-100 fl" href="login.html">登录</a></li>
    <li><a class="w-h-100" href="register.html">注册</a></li>
    <li><a class="w-h-100 fl" href="category.html">分类</a></li>
    <li><a class="w-h-100 fl" href="tag.html">标签墙</a></li>
    <li><a class="w-h-100 fl" href="archive.html">归档</a></li>
    <li><a class="w-h-100 fl" href="link.html">友情链接</a></li>
</ul>
<div id="d-audio" class="d-audio" style="width: 150px; z-index: 99; position: fixed; bottom: 5px; left: 5px;"></div>


<!--主体-->
<section class="main">

    <label for="article_id"></label><input hidden id="article_id" name="article_id" value="55">
    <label for="user_id"></label><input hidden id="user_id" name="user_id"
                                        value="{{ no such element: django.contrib.sessions.backends.cache.SessionStore object[&#39;user_id&#39;] }}">
    <div class="left-box">
        <div id="outerdiv">
            <div id="innerdiv" style="position:absolute;"><img alt id="bigimg"
                                                               style="box-shadow: 0 0 10px rgba(0,0,0,0.38)" src="" />
            </div>
        </div>
        <!--文章内容-->
        <div class="article-container">
            <div class="article-content markdown-body">
                <h1 style="margin: 10px 0" id="title">

                </h1>
                <!--点赞收藏编辑-->
                <div class="dian">
                    <div id="zan">
                        <img src="good.jpg">
                        <div id="num1">0</div>
                    </div>
                    <div id="cai">
                        <img src="collect.jpg">
                        <div id="num2">0</div>
                    </div>
                    <div id="edit">
                        <img src="edit.jpg">
                    </div>
                </div>

                <div class="article-cate">
                    <a href="category.html">个人思考</a>
                </div>
                <div class="writer-info">
                    <span style="margin: 5px 0;">作者: </span>
                    <span id="writer">

                    </span>
                    <span id="write-time"></span>
                </div>

                <h3 id="content">
                </h3>
            <div class="prev-next">
                <div class="p-div">
                    <span class="fl">上一篇：</span>
                    <a class="one-line-overflow fl" href="article.html" id="prev-a">孤独与狂欢</a>
                </div>
            </div>

                <button type="button" id="save" onclick="doedit()">保存</button>

            </div>
        </div>
        <!--评论-->
        <div class="comment-container" style="margin-top: 20px; margin-bottom: 10px">
            <div class="sort-box">
                    <span class="at-sort-s fl"><a style="box-sizing: content-box;"
                                                  class="at-sort-comment-a c-666">评论</a></span>
                <span class="location fl c-666"><a class="at-sort-detail c-666"></a> </span>
            </div>
            <input type="text" name="comment_content" id="comment_content" class="form-control"
                   placeholder="请输入评论">
            <div class="button-line">
                <span id="error-info"></span>
                <button type="button" id="publish-btn" onclick="check_comment()">发布</button>
            </div>
            <div class="total-count">
                共 <span id="comment-count"> </span> 条评论
            </div>

            <div class="comment-item">
                <div class="user-img-box">
                    <img src="辉夜.jpg"  alt="">
                </div>
                <div class="comment-box">
                    <div class="user-info">
                        <span class="user-name" id="observer">

                        </span>
                        <span class="publish-time" id="publish-time">

                        </span>

                    </div>
                    <div class="comment-content c-666">
                        <p id="content1">

                        </p>
                    </div>
                </div>
            </div>

            <div class="dian">
                <div id="zan1">
                    <img src="good.jpg">
                    <div id="num3">0</div>
                </div>
            </div>


            <div class="comment-item">
                <div class="user-img-box">
                    <img src="辉夜.jpg" alt="">
                </div>
                <div class="comment-box">
                    <div class="user-info">
                        <span class="user-name" id="observer2">

                        </span>
                        <span class="publish-time" id="publish-time2">

                        </span>
                    </div>

                    <div class="comment-content c-666">
                        <p id="content2">

                        </p>
                    </div>
                </div>
            </div>

        <div class="dian">
            <div id="zan2">
                <img src="good.jpg">
                <div id="num4">0</div>
            </div>
    </div>

        <div class="comment-item">
            <div class="user-img-box">

            </div>
            <div class="comment-box">
                <div class="user-info">
                        <span class="user-name" >
                         User
                        </span>
                    <span class="publish-time">
                        2020-x-x
                        </span>
                </div>

                <div class="comment-content c-666">
                    <p>
                        更多评论
                    </p>
                </div>
            </div>
        </div>
    </div>
    </div>
</section>
<!--尾部-->
<footer class="footer">
    <div class="footer-line">
        <div class="icon-center">
                <span class="icon-box"><a id="github-icon" target="_blank" href="https://github.com/zhaoyangkun"
                                          class="foot-icon"></a>
                </span>
            <span class="icon-box"><a id="qq-icon" target="_blank"
                                      href="tencent://Message/?Uin=2295098032&amp;websiteName=q-zone.qq.com&amp;Menu=yes"
                                      class="foot-icon"></a>
                </span>
        </div>
    </div>
</footer>
<script type="text/javascript" src="../js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="../js/sweetalert.min.js"></script>
<script type="text/javascript" src="../js/pace.min.js"></script>
<script type="text/javascript" src="../js/base.js"></script>
<script type="text/javascript" src="../js/d-audio.js"></script>
<script type="text/javascript" src="../js/vditor.min.js"></script>
<script type="text/javascript" src="../js/article-detail.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">



        MathJax.Hub.Config({
            showProcessingMessages: false, //关闭js加载过程信息
            messageStyle: "none", //不显示信息
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath:  [ ["$", "$"] ], //行内公式选择$
                displayMath: [ ["$$","$$"] ], //段内公式选择$$
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a'], //避开某些标签
                ignoreClass:"comment-content" //避开含该Class的标签
            },
            "HTML-CSS": {
                availableFonts: ["STIX","TeX"], //可选字体
                showMathMenu: false //关闭右击菜单显示
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    </script>
<script type="text/javascript" defer>

    //登录状态增加
    function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i].trim();
            if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
        }
        return "";
    }
    function exit() {
        setCookie("user_info","",-1);
        setCookie("user_id","",-1);
    }
    function setCookie(cname,cvalue,exdays)
    {
        var d = new Date();
        d.setTime(d.getTime()+(exdays*24*60*60*1000));
        var expires = "expires="+d.toGMTString();
        document.cookie = cname+"="+cvalue+"; "+expires;
    }
    jQuery(function() {
        //加载个人信息
        if (getCookie("user_info") != "") {
            var myname = getCookie("user_info");
            jQuery("#mylogin").html("<a class=\"a-login\" href=\"login.html\">"+myname+"</a>");
            jQuery("#myreg").html("<a class=\"a-login\" onclick=\"exit()\"href=\"index.html\">退出</a>");
            showUserInfo(myname);
        }
    });


    //音乐插件
    const myAudio = new Daudio({
        ele: '#d-audio',
        src: 'https://zhaoyangkun.gitee.io/blog-static/music/迷人的危险.mp3',
        imageurl: 'https://zhaoyangkun.gitee.io/blog-static/img/dance_flow.jpg',
        name: '迷人的危险',
        singer: 'dance flow',
        // 是否显示进度信息
        showprogress: true,
        // 是否循环
        loop: true,
        // '' 就是默认状态， cricle则是初始化就是圆形且可以旋转
        initstate: 'cricle',
        next: function () {},
        ended: function () {}
    });
    //myAudio.play();

    //图片懒加载
    const lazyImage = new LazyImage('.lazy-image');
</script>
</body>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/all",function(rst){//处理响应的结果
            var title1="";
            var json=rst[0];
            title1+=json.article_title;
            jQuery("#title").html(title1);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/all",function(rst){//处理响应的结果
            var date="";
            var json=rst[0];
            date+=json.article_date;
            jQuery("#write-time").html(date);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/all",function(rst){//处理响应的结果
            var content="";
            var json=rst[0];
            content+=json.article_content;
            jQuery("#content").html(content);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/find",function(rst){//处理响应的结果
            var count=rst.length;
            jQuery("#comment-count").html(count);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    function check_comment()
    {
        var comment_content=jQuery("#comment_content").val();
        var date=new Date().toLocaleDateString();
        //json格式的属性名称必须与后台对应
        jQuery.post("/savecomment",{"content":comment_content,"date":date},function(rst){
            alert(rst);
            //如果发布成功，重新加载数据
            if(rst=='发布成功')
            {
                //重新加载本页面
                location.reload();
            }
        });
    }
</script>
<script>
    function doedit()
    {
        var title=document.getElementById('title').innerText;
        var content=document.getElementById('content').innerText;
        var id=1;
        var date=new Date().toLocaleDateString();
        jQuery.post("/edit", {"content": content, "title": title, "date":date, "id": id}, function (rst) {
                alert(rst);
                //如果发布成功，重新加载数据
                if (rst == '修改成功') {
                    //重新加载本页面
                    location.reload();
                }
            });
     }
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/find",function(rst){//处理响应的结果
            var date="";
            var json=rst[0];
            date+=json.comment_date;
            jQuery("#publish-time").html(date);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/find",function(rst){//处理响应的结果
            var content="";
                var json = rst[0];
                content += json.comment_content;
            jQuery("#content1").html(content);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/findobserver",function(rst){//处理响应的结果
            var name="";
            var json=rst[0];
            name+=json.user_name;
            jQuery("#observer").html(name);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/find",function(rst){//处理响应的结果
            var date="";
            var json=rst[1];
            date+=json.comment_date;
            jQuery("#publish-time2").html(date);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/find",function(rst){//处理响应的结果
            var content="";
            var json = rst[1];
            content += json.comment_content;
            jQuery("#content2").html(content);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/findobserver",function(rst){//处理响应的结果
            var name1="";
            var json=rst[1];
            name1+=json.user_name;
            jQuery("#observer2").html(name1);
        },"json");//表示返回数据的格式
    });
</script>
<script>
    jQuery(function(){
        //页面加载完毕，就去数据库中获取数据
        jQuery.post("/findwriter",function(rst){//处理响应的结果
            var writer="";
            var json=rst[0];
            writer+=json.user_name;
            jQuery("#writer").html(writer);
        },"json");//表示返回数据的格式
    });
</script>
<script>
var zan = document.getElementById('zan');
var zan1 = document.getElementById('zan1');
var zan2 = document.getElementById('zan2');
var cai = document.getElementById('cai');
var edit=document.getElementById("edit");
var num1 = document.getElementById('num1');
var num2 = document.getElementById('num2');
var num3 = document.getElementById('num3');
var num4 = document.getElementById('num4');
var flag1 = 0;
var flag2 = 0;
var flag3=0;
var flag4=0;
zan.onclick = function() {
if (flag1 == 0) {
num1.innerHTML++;
}
if (flag1 == 1) {
num1.innerHTML--;
}
if (flag1 == 2) {
num1.innerHTML++;
flag1 = 0;
}
flag1++;
}
cai.onclick = function() {
if (flag2 == 0) {
num2.innerHTML++;
}
if (flag2 == 1) {
num2.innerHTML--;
}
if (flag2 == 2) {
num2.innerHTML++;
flag2 = 0;
}
flag2++;
}
zan1.onclick = function() {
    if (flag3 == 0) {
        num3.innerHTML++;
    }
    if (flag3 == 1) {
        num3.innerHTML--;
    }
    if (flag3 == 2) {
        num3.innerHTML++;
        flag3 = 0;
    }
    flag3++;
}
zan2.onclick = function() {
    if (flag4 == 0) {
        num4.innerHTML++;
    }
    if (flag4 == 1) {
        num4.innerHTML--;
    }
    if (flag4 == 2) {
        num4.innerHTML++;
        flag4 = 0;
    }
    flag4++;
}
edit.onclick=function(){
    document.getElementById('content').contentEditable=true;
    document.getElementById("save").style.display="block";
}
</script>
<script>
     document.getElementById("save").style.display="none";
</script>
</html>